!function(e){"use strict";e(document).ready(function(){e(".devvn_list_box").masonry({itemSelector:".devvn_list_item"});var o=function(){e("body .devvn-reviews-img-popup").magnificPopup({type:"inline",mainClass:"devvn-shortcode-reviews-popup devvn-reviews-popup",showCloseBtn:!0,closeOnBgClick:!0,gallery:{enabled:!0,navigateByImgClick:!0,preload:1},callbacks:{change:function(){if(0==devvn_shortcode_reviews.disable_owl_slider){let o=e(".devvn_review_image_slider",this.content);e(".img_item",o).length>1&&!o.hasClass("owl-carousel")&&o.addClass("owl-carousel").owlCarousel({loop:!1,dots:!1,items:1,nav:!0})}},open:function(){if(0==devvn_shortcode_reviews.disable_owl_slider){let o=e(".devvn_review_image_slider",this.wrap);e(".img_item",o).length>1&&!o.hasClass("owl-carousel")&&o.addClass("owl-carousel").owlCarousel({loop:!1,dots:!1,items:1,nav:!0})}}}})};function t(){e(".devvn_review_popup_img").remove()}o(),e("body").on("init",function(){o()}),e(".devvn_shortcode_review_loadmore").on("click",function(){let t=e(this),i=parseInt(t.attr("data-page")),n=t.data("options"),s=t.closest(".devvn_shortcode_list_reviews");return e.ajax({type:"post",dataType:"json",url:devvn_shortcode_reviews.ajax_url,data:{action:"get_shortcode_reviews",paged:i,options:n},context:this,beforeSend:function(){s.addClass("devvn_loading")},success:function(i){if(i.success){let n=i.data.maxpage,a=i.data.current_page,d=i.data.review_item;a>=n&&e(".devvn_shortcode_reviews_paging",s).remove(),t.attr("data-page",a+1),e.each(d,function(o,t){let i=e(t);e(".devvn_list_box",s).append(i).masonry("appended",i)}),o()}else alert(i.data);s.removeClass("devvn_loading")},error:function(e,o,t){s.removeClass("devvn_loading"),alert("Có lỗi không xác định")}}),!1}),e("body").on("click",".devvn_review_image_slider .img_item a",function(){if(0==devvn_shortcode_reviews.enable_img_popup)return!1;let o=e(this).closest(".devvn_review_image_slider"),t="";return e(".img_item a",o).each(function(){let o='<img src="'+e(this).attr("href")+'" alt=""><br>';t+=o}),e("body").append('<div class="devvn_review_popup_img"><button type="button" class="devvn_review_popup_close">×</button><div class="devvn_review_popup_wrap"><div class="devvn_review_popup_box">'+t+"</div></div></div>"),!1}),e("body").on("click",".devvn_review_popup_close",function(){t()}),e(document).on("mouseup",".devvn_review_popup_img",function(o){var i=e("img");i.is(o.target)||0!==i.has(o.target).length||t()}),e("body").on("click",".view_more_img",function(t){t.preventDefault();let i=e(this).closest(".img_reviews_wrap"),n=e(this).data("prod_id"),s=e(".img_reviews_box_full .devvn_list_box",i),a=e(".img_reviews_box_full .devvn_list_popup_title",i);""==s.html()?e.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"get_reviews_has_img",prod_id:n},context:this,beforeSend:function(){i.addClass("devvn_loading")},success:function(t){if(t.success){e("html").addClass("openPopup");let i=t.data.review_item,n=t.data.title_popup;e.each(i,function(o,t){let i=e(t);s.append(i).masonry("appended",i)}),a.html(n),s.masonry("layout"),o()}else alert(t.data);i.removeClass("devvn_loading")},error:function(e,o,t){alert(o),i.removeClass("devvn_loading")}}):e("html").addClass("openPopup")}),e("body").on("click",".devvn_list_popup_close",function(){e("html").removeClass("openPopup")})})}(jQuery)