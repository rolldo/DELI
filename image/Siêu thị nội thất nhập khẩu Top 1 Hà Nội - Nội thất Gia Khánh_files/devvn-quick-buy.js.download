!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(window.jQuery||window.Zepto)}(function(e){var t,n,a,o,i,r,s="Close",c="BeforeClose",u="MarkupParse",p="mfp",l="."+p,d="mfp-ready",v="mfp-removing",m=function(){},_=!!window.jQuery,f=e(window),h=function(e,n){t.ev.on(p+e+l,n)},g=function(t,n,a,o){var i=document.createElement("div");return i.className="mfp-"+t,a&&(i.innerHTML=a),o?n&&n.appendChild(i):(i=e(i),n&&i.appendTo(n)),i},y=function(n,a){t.ev.triggerHandler(p+n,a),t.st.callbacks&&(n=n.charAt(0).toLowerCase()+n.slice(1),t.st.callbacks[n]&&t.st.callbacks[n].apply(t,e.isArray(a)?a:[a]))},b=function(n){return n===r&&t.currTemplate.closeBtn||(t.currTemplate.closeBtn=e(t.st.closeMarkup.replace("%title%",t.st.tClose)),r=n),t.currTemplate.closeBtn},k=function(){e.magnificPopup.instance||((t=new m).init(),e.magnificPopup.instance=t)};m.prototype={constructor:m,init:function(){var n=navigator.appVersion;t.isLowIE=t.isIE8=document.all&&!document.addEventListener,t.isAndroid=/android/gi.test(n),t.isIOS=/iphone|ipad|ipod/gi.test(n),t.supportsTransition=function(){var e=document.createElement("p").style,t=["ms","O","Moz","Webkit"];if(void 0!==e.transition)return!0;for(;t.length;)if(t.pop()+"Transition"in e)return!0;return!1}(),t.probablyMobile=t.isAndroid||t.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),a=e(document),t.popupsCache={}},open:function(n){var o;if(!1===n.isObj){t.items=n.items.toArray(),t.index=0;var r,s=n.items;for(o=0;o<s.length;o++)if((r=s[o]).parsed&&(r=r.el[0]),r===n.el[0]){t.index=o;break}}else t.items=e.isArray(n.items)?n.items:[n.items],t.index=n.index||0;if(!t.isOpen){t.types=[],i="",n.mainEl&&n.mainEl.length?t.ev=n.mainEl.eq(0):t.ev=a,n.key?(t.popupsCache[n.key]||(t.popupsCache[n.key]={}),t.currTemplate=t.popupsCache[n.key]):t.currTemplate={},t.st=e.extend(!0,{},e.magnificPopup.defaults,n),t.fixedContentPos="auto"===t.st.fixedContentPos?!t.probablyMobile:t.st.fixedContentPos,t.st.modal&&(t.st.closeOnContentClick=!1,t.st.closeOnBgClick=!1,t.st.showCloseBtn=!1,t.st.enableEscapeKey=!1),t.bgOverlay||(t.bgOverlay=g("bg").on("click"+l,function(){t.close()}),t.wrap=g("wrap").attr("tabindex",-1).on("click"+l,function(e){t._checkIfClose(e.target)&&t.close()}),t.container=g("container",t.wrap)),t.contentContainer=g("content"),t.st.preloader&&(t.preloader=g("preloader",t.container,t.st.tLoading));var c=e.magnificPopup.modules;for(o=0;o<c.length;o++){var p=c[o];p=p.charAt(0).toUpperCase()+p.slice(1),t["init"+p].call(t)}y("BeforeOpen"),t.st.showCloseBtn&&(t.st.closeBtnInside?(h(u,function(e,t,n,a){n.close_replaceWith=b(a.type)}),i+=" mfp-close-btn-in"):t.wrap.append(b())),t.st.alignTop&&(i+=" mfp-align-top"),t.fixedContentPos?t.wrap.css({overflow:t.st.overflowY,overflowX:"hidden",overflowY:t.st.overflowY}):t.wrap.css({top:f.scrollTop(),position:"absolute"}),(!1===t.st.fixedBgPos||"auto"===t.st.fixedBgPos&&!t.fixedContentPos)&&t.bgOverlay.css({height:a.height(),position:"absolute"}),t.st.enableEscapeKey&&a.on("keyup"+l,function(e){27===e.keyCode&&t.close()}),f.on("resize"+l,function(){t.updateSize()}),t.st.closeOnContentClick||(i+=" mfp-auto-cursor"),i&&t.wrap.addClass(i);var v=t.wH=f.height(),m={};if(t.fixedContentPos&&t._hasScrollBar(v)){var _=t._getScrollbarSize();_&&(m.marginRight=_)}t.fixedContentPos&&(t.isIE7?e("body, html").css("overflow","hidden"):m.overflow="hidden");var k=t.st.mainClass;return t.isIE7&&(k+=" mfp-ie7"),k&&t._addClassToMFP(k),t.updateItemHTML(),y("BuildControls"),e("html").css(m),t.bgOverlay.add(t.wrap).prependTo(t.st.prependTo||e(document.body)),t._lastFocusedEl=document.activeElement,setTimeout(function(){t.content?(t._addClassToMFP(d),t._setFocus()):t.bgOverlay.addClass(d),a.on("focusin"+l,t._onFocusIn)},16),t.isOpen=!0,t.updateSize(v),y("Open"),n}t.updateItemHTML()},close:function(){t.isOpen&&(y(c),t.isOpen=!1,t.st.removalDelay&&!t.isLowIE&&t.supportsTransition?(t._addClassToMFP(v),setTimeout(function(){t._close()},t.st.removalDelay)):t._close())},_close:function(){y(s);var n=v+" "+d+" ";if(t.bgOverlay.detach(),t.wrap.detach(),t.container.empty(),t.st.mainClass&&(n+=t.st.mainClass+" "),t._removeClassFromMFP(n),t.fixedContentPos){var o={marginRight:""};t.isIE7?e("body, html").css("overflow",""):o.overflow="",e("html").css(o)}a.off("keyup.mfp focusin"+l),t.ev.off(l),t.wrap.attr("class","mfp-wrap").removeAttr("style"),t.bgOverlay.attr("class","mfp-bg"),t.container.attr("class","mfp-container"),t.st.showCloseBtn&&(!t.st.closeBtnInside||!0===t.currTemplate[t.currItem.type])&&t.currTemplate.closeBtn&&t.currTemplate.closeBtn.detach(),t.st.autoFocusLast&&t._lastFocusedEl&&e(t._lastFocusedEl).focus(),t.currItem=null,t.content=null,t.currTemplate=null,t.prevHeight=0,y("AfterClose")},updateSize:function(e){if(t.isIOS){var n=document.documentElement.clientWidth/window.innerWidth,a=window.innerHeight*n;t.wrap.css("height",a),t.wH=a}else t.wH=e||f.height();t.fixedContentPos||t.wrap.css("height",t.wH),y("Resize")},updateItemHTML:function(){var n=t.items[t.index];t.contentContainer.detach(),t.content&&t.content.detach(),n.parsed||(n=t.parseEl(t.index));var a=n.type;if(y("BeforeChange",[t.currItem?t.currItem.type:"",a]),t.currItem=n,!t.currTemplate[a]){var i=!!t.st[a]&&t.st[a].markup;y("FirstMarkupParse",i),t.currTemplate[a]=!i||e(i)}o&&o!==n.type&&t.container.removeClass("mfp-"+o+"-holder");var r=t["get"+a.charAt(0).toUpperCase()+a.slice(1)](n,t.currTemplate[a]);t.appendContent(r,a),n.preloaded=!0,y("Change",n),o=n.type,t.container.prepend(t.contentContainer),y("AfterChange")},appendContent:function(e,n){t.content=e,e?t.st.showCloseBtn&&t.st.closeBtnInside&&!0===t.currTemplate[n]?t.content.find(".mfp-close").length||t.content.append(b()):t.content=e:t.content="",y("BeforeAppend"),t.container.addClass("mfp-"+n+"-holder"),t.contentContainer.append(t.content)},parseEl:function(n){var a,o=t.items[n];if(o.tagName?o={el:e(o)}:(a=o.type,o={data:o,src:o.src}),o.el){for(var i=t.types,r=0;r<i.length;r++)if(o.el.hasClass("mfp-"+i[r])){a=i[r];break}o.src=o.el.attr("data-mfp-src"),o.src||(o.src=o.el.attr("href"))}return o.type=a||t.st.type||"inline",o.index=n,o.parsed=!0,t.items[n]=o,y("ElementParse",o),t.items[n]},addGroup:function(e,n){var a=function(a){a.mfpEl=this,t._openClick(a,e,n)};n||(n={});var o="click.magnificPopup";n.mainEl=e,n.items?(n.isObj=!0,e.off(o).on(o,a)):(n.isObj=!1,n.delegate?e.off(o).on(o,n.delegate,a):(n.items=e,e.off(o).on(o,a)))},_openClick:function(n,a,o){if((void 0!==o.midClick?o.midClick:e.magnificPopup.defaults.midClick)||!(2===n.which||n.ctrlKey||n.metaKey||n.altKey||n.shiftKey)){var i=void 0!==o.disableOn?o.disableOn:e.magnificPopup.defaults.disableOn;if(i)if(e.isFunction(i)){if(!i.call(t))return!0}else if(f.width()<i)return!0;n.type&&(n.preventDefault(),t.isOpen&&n.stopPropagation()),o.el=e(n.mfpEl),o.delegate&&(o.items=a.find(o.delegate)),t.open(o)}},updateStatus:function(e,a){if(t.preloader){n!==e&&t.container.removeClass("mfp-s-"+n),!a&&"loading"===e&&(a=t.st.tLoading);var o={status:e,text:a};y("UpdateStatus",o),e=o.status,a=o.text,t.preloader.html(a),t.preloader.find("a").on("click",function(e){e.stopImmediatePropagation()}),t.container.addClass("mfp-s-"+e),n=e}},_checkIfClose:function(n){if(!e(n).hasClass("mfp-prevent-close")){var a=t.st.closeOnContentClick,o=t.st.closeOnBgClick;if(a&&o)return!0;if(!t.content||e(n).hasClass("mfp-close")||t.preloader&&n===t.preloader[0])return!0;if(n===t.content[0]||e.contains(t.content[0],n)){if(a)return!0}else if(o&&e.contains(document,n))return!0;return!1}},_addClassToMFP:function(e){t.bgOverlay.addClass(e),t.wrap.addClass(e)},_removeClassFromMFP:function(e){this.bgOverlay.removeClass(e),t.wrap.removeClass(e)},_hasScrollBar:function(e){return(t.isIE7?a.height():document.body.scrollHeight)>(e||f.height())},_setFocus:function(){(t.st.focus?t.content.find(t.st.focus).eq(0):t.wrap).focus()},_onFocusIn:function(n){if(n.target!==t.wrap[0]&&!e.contains(t.wrap[0],n.target))return t._setFocus(),!1},_parseMarkup:function(t,n,a){var o;a.data&&(n=e.extend(a.data,n)),y(u,[t,n,a]),e.each(n,function(n,a){if(void 0===a||!1===a)return!0;if((o=n.split("_")).length>1){var i=t.find(l+"-"+o[0]);if(i.length>0){var r=o[1];"replaceWith"===r?i[0]!==a[0]&&i.replaceWith(a):"img"===r?i.is("img")?i.attr("src",a):i.replaceWith(e("<img>").attr("src",a).attr("class",i.attr("class"))):i.attr(o[1],a)}}else t.find(l+"-"+n).html(a)})},_getScrollbarSize:function(){if(void 0===t.scrollbarSize){var e=document.createElement("div");e.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(e),t.scrollbarSize=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return t.scrollbarSize}},e.magnificPopup={instance:null,proto:m.prototype,modules:[],open:function(t,n){return k(),(t=t?e.extend(!0,{},t):{}).isObj=!0,t.index=n||0,this.instance.open(t)},close:function(){return e.magnificPopup.instance&&e.magnificPopup.instance.close()},registerModule:function(t,n){n.options&&(e.magnificPopup.defaults[t]=n.options),e.extend(this.proto,n.proto),this.modules.push(t)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,showCloseBtn:!0,enableEscapeKey:!0,modal:!1,alignTop:!1,removalDelay:0,prependTo:null,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&#215;</button>',tClose:"Close (Esc)",tLoading:"Loading...",autoFocusLast:!0}},e.fn.magnificPopup=function(n){k();var a=e(this);if("string"==typeof n)if("open"===n){var o,i=_?a.data("magnificPopup"):a[0].magnificPopup,r=parseInt(arguments[1],10)||0;i.items?o=i.items[r]:(o=a,i.delegate&&(o=o.find(i.delegate)),o=o.eq(r)),t._openClick({mfpEl:o},a,i)}else t.isOpen&&t[n].apply(t,Array.prototype.slice.call(arguments,1));else n=e.extend(!0,{},n),_?a.data("magnificPopup",n):a[0].magnificPopup=n,t.addGroup(a,n);return a};var C,w,x,q="inline",T=function(){x&&(w.after(x.addClass(C)).detach(),x=null)};e.magnificPopup.registerModule(q,{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){t.types.push(q),h(s+"."+q,function(){T()})},getInline:function(n,a){if(T(),n.src){var o=t.st.inline,i=e(n.src);if(i.length){var r=i[0].parentNode;r&&r.tagName&&(w||(C=o.hiddenClass,w=g(C),C="mfp-"+C),x=i.after(w).detach().removeClass(C)),t.updateStatus("ready")}else t.updateStatus("error",o.tNotFound),i=e("<div>");return n.inlineElement=i,i}return t.updateStatus("ready"),t._parseMarkup(a,{},n),a}}});var O;e.magnificPopup.registerModule("zoom",{options:{enabled:!1,easing:"ease-in-out",duration:300,opener:function(e){return e.is("img")?e:e.find("img")}},proto:{initZoom:function(){var e,n=t.st.zoom,a=".zoom";if(n.enabled&&t.supportsTransition){var o,i,r=n.duration,u=function(e){var t=e.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),a="all "+n.duration/1e3+"s "+n.easing,o={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},i="transition";return o["-webkit-"+i]=o["-moz-"+i]=o["-o-"+i]=o[i]=a,t.css(o),t},p=function(){t.content.css("visibility","visible")};h("BuildControls"+a,function(){if(t._allowZoom()){if(clearTimeout(o),t.content.css("visibility","hidden"),!(e=t._getItemToZoom()))return void p();(i=u(e)).css(t._getOffset()),t.wrap.append(i),o=setTimeout(function(){i.css(t._getOffset(!0)),o=setTimeout(function(){p(),setTimeout(function(){i.remove(),e=i=null,y("ZoomAnimationEnded")},16)},r)},16)}}),h(c+a,function(){if(t._allowZoom()){if(clearTimeout(o),t.st.removalDelay=r,!e){if(!(e=t._getItemToZoom()))return;i=u(e)}i.css(t._getOffset(!0)),t.wrap.append(i),t.content.css("visibility","hidden"),setTimeout(function(){i.css(t._getOffset())},16)}}),h(s+a,function(){t._allowZoom()&&(p(),i&&i.remove(),e=null)})}},_allowZoom:function(){return"image"===t.currItem.type},_getItemToZoom:function(){return!!t.currItem.hasSize&&t.currItem.img},_getOffset:function(n){var a,o=(a=n?t.currItem.img:t.st.zoom.opener(t.currItem.el||t.currItem)).offset(),i=parseInt(a.css("padding-top"),10),r=parseInt(a.css("padding-bottom"),10);o.top-=e(window).scrollTop()-i;var s={width:a.width(),height:(_?a.innerHeight():a[0].offsetHeight)-r-i};return void 0===O&&(O=void 0!==document.createElement("p").style.MozTransform),O?s["-moz-transform"]=s.transform="translate("+o.left+"px,"+o.top+"px)":(s.left=o.left,s.top=o.top),s}}}),k()}),function(e){e(document).ready(function(){var t={set:function(e,n,a){var o,i,r,s,c;a?((r=new Date).setTime(r.getTime()+24*a*60*60*1e3),s="; expires="+r.toGMTString()):s="",1===(c=location.host).split(".").length?document.cookie=e+"="+n+s+"; path=/":((i=c.split(".")).shift(),o="."+i.join("."),document.cookie=e+"="+n+s+"; path=/; domain="+o,null!=t.get(e)&&t.get(e)==n||(o="."+c,document.cookie=e+"="+n+s+"; path=/; domain="+o))},get:function(e){for(var t=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){for(var o=n[a];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null},erase:function(e){t.set(e,"",-1)}};function n(t){var n=e(".summary.entry-summary > .cart"),a=e(".devvn_prod_variable .cart",t);e("select, input, textarea",n).each(function(){var t=e(this).attr("name"),n=e(this).val(),o=e(this).data("attribute_name");e('[name="'+t+'"]',a).val(n).trigger("change"),e('.ux-swatches[data-attribute_name="'+o+'"]',a).length>0&&e('.ux-swatches[data-attribute_name="'+o+'"] .ux-swatch[data-value="'+n+'"]:not(".selected")',a).trigger("click")}),a.trigger("check_variations"),o(t)}function a(t){var n=e(".summary.entry-summary > .cart"),a=e(".devvn_prod_variable .cart",t);e("select, input, textarea",a).each(function(){var t=e(this).attr("name"),a=e(this).val(),o=e(this).data("attribute_name");e('[name="'+t+'"]',n).val(a).trigger("change"),e('.ux-swatches[data-attribute_name="'+o+'"]',n).length>0&&e('.ux-swatches[data-attribute_name="'+o+'"] .ux-swatch[data-value="'+a+'"]:not(".selected")',n).trigger("click")}),n.trigger("check_variations"),o(t)}function o(t){var n=e(".devvn_prod_variable .cart",t).data("product_variations"),a=e('.devvn_prod_variable input[name="quantity"]',t).val(),o=e('.devvn_prod_variable input[name="variation_id"]',t).val(),r=total=ship=0;(e("#enable_ship",t).val()||0)&&e(".popup_quickbuy_shipping_calc",t).length>0&&e('.popup_quickbuy_shipping_calc input[name="shipping_method[0]"]',t).length>0&&(ship=parseInt(e('.popup_quickbuy_shipping_calc input[name="shipping_method[0]"]:checked',t).data("cost")),ship||1!=e('.popup_quickbuy_shipping_calc input[name="shipping_method[0]"]',t).length||(ship=parseInt(e('.popup_quickbuy_shipping_calc input[name="shipping_method[0]"]',t).data("cost")))),n?e(n).each(function(e,t){t.variation_id==o&&t.variation_is_active&&t.variation_is_visible&&(r=t.display_price)}):r=e(".devvn_prod_variable",t).data("simpleprice");var s=parseFloat(e(".coupon_amout_val",t).val())||0;total=r*a+ship-s,total?(e(".popup_quickbuy_total_calc",t).html(i(total.toFixed(0),0,"",".")+" "+devvn_quickbuy_array.currency_format),e(".popup_quickbuy_total_calc",t).closest(".popup-customer-info-group").show(),e(".paymentmethob-wrap, .paymentmethob_title",t).show()):(e(".popup_quickbuy_total_calc",t).closest(".popup-customer-info-group").hide(),e(".paymentmethob-wrap, .paymentmethob_title",t).hide()),e("#order_total",t).val(total)}function i(e,t,n,a){t=devvn_quickbuy_array.num_decimals,n=devvn_quickbuy_array.price_decimal,a=devvn_quickbuy_array.price_thousand,e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var o=isFinite(+e)?+e:0,i=isFinite(+t)?Math.abs(t):0,r=void 0===a?",":a,s=void 0===n?".":n,c="";return(c=(i?function(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}(o,i):""+Math.round(o)).split("."))[0].length>3&&(c[0]=c[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,r)),(c[1]||"").length<i&&(c[1]=c[1]||"",c[1]+=new Array(i-c[1].length+1).join("0")),c.join(s)}function r(){e("body .devvn_prod_variable").length>0&&0==e("body .devvn_prod_variable .quantity.buttons_added .screen-reader-text").length&&e("body .devvn_prod_variable .quantity.buttons_added").append('<label class="screen-reader-text">'+devvn_quickbuy_array.qty_text+"</label>"),e("body .devvn-popup-quickbuy").each(function(t,n){var a=e(this),i=e(".devvn_cusstom_info",a);i.validate({rules:{"customer-name":{required:!0,maxlength:100},"customer-phone":{required:{depends:function(){return e(this).val(e.trim(e(this).val())),!0}},vietnamphone2:!0},"customer-valid-phone":{required:{depends:function(){return e(this).val(e.trim(e(this).val())),!0}},vietnamphone2:!0},"customer-quan":{required:function(t){return 1==e("#require_district").val()}},"customer-xa":{required:function(t){return 1==e("#require_village").val()}},"customer-address":{required:function(t){return 1==e("#require_address").val()}},"customer-email":{required:function(t){return 1==e(t).data("required")},customemail:!0}},messages:{"customer-name":devvn_quickbuy_array.name_text,"customer-phone":devvn_quickbuy_array.phone_text,"customer-valid-phone":{required:devvn_quickbuy_array.valid_phone_text,equalTo:devvn_quickbuy_array.valid_phone_text_equalto},"customer-email":devvn_quickbuy_array.email_text,"customer-quan":devvn_quickbuy_array.quan_text,"customer-xa":devvn_quickbuy_array.xa_text,"customer-address":devvn_quickbuy_array.address_text},errorLabelContainer:e(".devvn_quickbuy_mess",i)});var r=e("#enable_ship",a).val()||0;if(e("#devvn_city",a).length>0){var s=!1,c=e("#prod_nonce",a).val(),u=0;e('button.single_add_to_cart_button[name="add-to-cart"]',a).length>0&&(u=parseInt(e('button.single_add_to_cart_button[name="add-to-cart"]',a).val())),e("#devvn_city",a).on("change",function(t){var n=t.val;if(n||(n=e("#devvn_city option:selected",a).val()),n&&!s){var i=e(".devvn_prod_variable .cart",a).serialize();e.ajax({type:"post",dataType:"json",url:devvn_quickbuy_array.ajaxurl,data:{action:"quickbuy_load_diagioihanhchinh",matp:n,getvalue:1,product_info:i,nonce:c,prod_id:u},context:this,beforeSend:function(){e(".popup-customer-info",a).addClass("popup_loading"),s=!0},success:function(t){if(e("#devvn_district",a).html(""),e("#devvn_ward",a).html('<option value="">Xã/phường</option>'),t.success){var n=t.data.list_district,i=new Option("Quận/huyện","");e("#devvn_district",a).append(i),e.each(n,function(t,n){var o=new Option(n.name,n.maqh);e("#devvn_district",a).append(o)}),r&&t.data.shipping&&e(".popup_quickbuy_shipping_calc",a).html(t.data.shipping)}s=!1,e(".popup-customer-info",a).removeClass("popup_loading"),o(a)}})}}),e("#devvn_district",a).length>0&&e("#devvn_district",a).on("change",function(t){var n=t.val;n||(n=e("#devvn_district option:selected",a).val());var i=e("#devvn_city option:selected",a).val();if(n&&!s){var p=e(".devvn_prod_variable .cart",a).serialize();e.ajax({type:"post",dataType:"json",url:devvn_quickbuy_array.ajaxurl,data:{action:"quickbuy_load_diagioihanhchinh",matp:i,maqh:n,getvalue:2,product_info:p,nonce:c,prod_id:u},context:this,beforeSend:function(){e(".popup-customer-info",a).addClass("popup_loading"),s=!0},success:function(t){if(e("#devvn_ward",a).html(""),t.success){var n=t.data.list_district,i=new Option("Xã/phường","");e("#devvn_ward",a).append(i),e.each(n,function(t,n){var o=new Option(n.name,n.xaid);e("#devvn_ward",a).append(o)}),r&&t.data.shipping&&e(".popup_quickbuy_shipping_calc",a).html(t.data.shipping)}s=!1,e(".popup-customer-info",a).removeClass("popup_loading"),o(a)}})}}),e("#devvn_ward",a).length>0&&1==devvn_quickbuy_array.enable_ward_ship&&e("#devvn_ward",a).on("change",function(t){e(".devvn_prod_variable .cart",a).trigger("change")}),e(window).on("load",function(){e("#devvn_city",a).trigger("change")});var p=null;e(".devvn_prod_variable .cart",a).on("change",function(t){if(r){var n=e("#devvn_district option:selected",a).val(),i=e("#devvn_city option:selected",a).val(),s=e("#devvn_ward option:selected",a).val(),l=e(".devvn_prod_variable .cart",a).serialize();p&&p.abort(),p=e.ajax({type:"post",dataType:"json",url:devvn_quickbuy_array.ajaxurl,data:{action:"quickbuy_load_diagioihanhchinh",matp:i,maqh:n,xaid:s,getvalue:1,product_info:l,nonce:c,prod_id:u},context:this,beforeSend:function(){e(".popup-customer-info",a).addClass("popup_loading")},success:function(t){t.success&&r&&t.data.shipping&&e(".popup_quickbuy_shipping_calc",a).html(t.data.shipping),e(".popup-customer-info",a).removeClass("popup_loading"),o(a),p=null},error:function(e,t,n){p=null}})}})}e('#devvn_cusstom_info, .devvn_prod_variable .cart, .devvn_prod_variable .quantity input[type="number"], input.variation_id',a).on("change",function(){o(a)}),e(".devvn-form-quickbuy-inline").length>0&&o(a),devvn_quickbuy_array.fix_calc&&jQuery(".devvn_prod_variable form.cart").on("change",function(){o(e("body .mfp-wrap.le-van-toan .devvn-popup-quickbuy"))})})}function s(n){var a=t.get("quickbuy_infor");a&&(a=e.parseJSON(a),!e('input[name="customer-name"]',n).val()&&e('input[name="customer-name"]',n).val(a.name),!e('input[name="customer-phone"]',n).val()&&e('input[name="customer-phone"]',n).val(a.phone),!e('input[name="customer-email"]',n).val()&&e('input[name="customer-email"]',n).val(a.email),!e('input[name="customer-address"]',n).val()&&e('input[name="customer-address"]',n).val(a.address))}e("body").on("click",".devvn_buy_now",function(){var t=e(this).data("id"),i=e("#popup_content_"+t);e(this).hasClass("devvn_buy_now_ajax")?e.ajax({type:"post",dataType:"html",url:devvn_quickbuy_array.ajaxurl,data:{action:"devvn_form_quickbuy",prodid:t},context:this,beforeSend:function(){e(this).addClass("popup_loading")},success:function(c){e.magnificPopup.open({items:{src:c,type:"inline"},showCloseBtn:!1,closeOnBgClick:!1,mainClass:"le-van-toan",callbacks:{open:function(){var a=e("#popup_content_"+t);r(),e("#devvn_city",a).trigger("change"),o(a),s(a),"undefined"!=typeof wc_add_to_cart_variation_params&&e(".variations_form").each(function(){e(this).wc_variation_form()}),n(a)},close:function(){a(i)}}}),e(this).removeClass("popup_loading")},error:function(t,n,a){e(this).removeClass("popup_loading")}}):e.magnificPopup.open({items:{src:"#popup_content_"+t,type:"inline"},showCloseBtn:!1,closeOnBgClick:!1,mainClass:"le-van-toan",callbacks:{open:function(){n(i),s(i),(e("#enable_ship",i).val()||0)&&e(".popup_quickbuy_shipping_calc",i).length>0&&e('.popup_quickbuy_shipping_calc input[name="shipping_method[0]"]',i).length<=0&&e("#devvn_city",i).trigger("change")},close:function(){a(i)}}})}),e(document).on("click",".devvn-popup-close",function(t){t.preventDefault(),e.magnificPopup.close()}),e.validator.addMethod("vietnamphone2",function(e,t){return!devvn_quickbuy_array.vietnamphone||/^0+(\d{9,10})$/.test(e)},"Số điện thoại không đúng định dạng."),e.validator.addMethod("customemail",function(e,t){return""==e||/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)},"Định dạng email không đúng."),r();var c=!1;e("body").on("click",".devvn-order-btn",function(){var n=e(this).closest(".devvn-popup-quickbuy"),a=e(".devvn_cusstom_info",n),o=e('.devvn_prod_variable .cart input[name="variation_id"]',n).val(),i=!0;if("string"==typeof o&&"0"!=o&&""!=o||void 0===o){var r=e(".cart",n).data("product_variations");if(r&&e.each(r,function(e,t){t.variation_id==o&&(t.is_purchasable&&t.is_in_stock&&t.variation_is_visible||(i=!1))}),i){if(!a.valid())return;var s=e("#prod_nonce",n).val(),u=e("#prod_id",n).val(),p=e("#devvn_cusstom_info",n).serialize(),l=e(".devvn_prod_variable .cart",n).serialize(),d={name:e('input[name="customer-name"]',n).val()||"",gender:e('input[name="customer-gender"]:checked',n).val()||"",phone:e('input[name="customer-phone"]',n).val()||"",email:e('input[name="customer-email"]',n).val()||"",address:e('input[name="customer-address"]',n).val()||""};c||e.ajax({type:"post",dataType:"json",url:devvn_quickbuy_array.ajaxurl,data:{action:"devvn_quickbuy",prod_id:u,customer_info:p,product_info:l,nonce:s},context:this,beforeSend:function(){c=!0,e(".devvn-order-btn",n).addClass("loading")},success:function(a){a.success?(t.set("quickbuy_infor",JSON.stringify(d)),a.data.gotothankyou&&a.data.thankyou_link?window.location.href=a.data.thankyou_link:(e(".devvn-popup-content",n).html(a.data.content),c=!1,e(".devvn-order-btn",n).removeClass("loading"))):(a.data?alert(a.data):alert(devvn_quickbuy_array.popup_error),c=!1,e(".devvn-order-btn",n).removeClass("loading"))},error:function(t,a,o){alert(devvn_quickbuy_array.popup_error),c=!1,e(".devvn-order-btn",n).removeClass("loading")}})}else alert(devvn_quickbuy_array.out_of_stock_mess)}else alert(wc_add_to_cart_variation_params.i18n_make_a_selection_text);return!1});var u=!1;e("body").on("click",".apply_coupon",function(){var t=e(this).closest(".devvn-popup-quickbuy"),n=e(".customer_coupon_wrap",t),a=e(".customer_coupon_field_mess ",t),r=e(".quickbuy_coupon_mess_amout ",t),s=e(".quickbuy_coupon_mess",t),c=e(".coupon_amout_val",t),p=e(".quickbuy_coupon_amout",t),l=e(".customer-coupon",t).val(),d=e(".devvn_prod_variable .cart",t).serialize(),v=0;return e('button.single_add_to_cart_button[name="add-to-cart"]',t).length>0&&(v=parseInt(e('button.single_add_to_cart_button[name="add-to-cart"]',t).val())),u||e.ajax({type:"post",dataType:"json",url:devvn_quickbuy_array.ajaxurl,data:{action:"devvn_apply_coupon",prod_id:v,thisCoupon:l,product_info:d},context:this,beforeSend:function(){u=!0,n.addClass("popup_loading")},success:function(e){a.show(),s.html("").show(),e.success?(amout_coupon=e.data.total_discount,s.html(e.data.mess),c.val(amout_coupon),amout_coupon?(r.show(),p.html(i(amout_coupon.toFixed(0),0,"",".")+" "+devvn_quickbuy_array.currency_format)):r.hide()):s.html(e.data),o(t),setTimeout(function(){s.html("").hide()},2e3),u=!1,n.removeClass("popup_loading")},error:function(e,t,a){u=!1,n.removeClass("popup_loading")}}),!1})})}(jQuery)